// script.js - XFollowDZ front-end (localStorage based)
// Config
const ADMIN_WHATSAPP = '213655643510'; // Ø£Ø¯Ù…Ù† ÙˆØ§ØªØ³Ø§Ø¨ (Ø¨Ø¯ÙˆÙ† +)
const BINANCE_ID = '782102873'; // Binance pay ID
const SERVICES = [
  {id:'fb_follow', name:'Ù…ØªØ§Ø¨Ø¹ÙŠÙ† ÙÙŠØ³Ø¨ÙˆÙƒ', pricePer100:0.10, unitText:'Ù„ÙƒÙ„ 100'},
  {id:'fb_like', name:'Ù„Ø§ÙŠÙƒØ§Øª ÙÙŠØ³Ø¨ÙˆÙƒ', pricePer100:0.05, unitText:'Ù„ÙƒÙ„ 100'},
  {id:'ig_views', name:'Ù…Ø´Ø§Ù‡Ø¯Ø§Øª Ø¥Ù†Ø³ØªØºØ±Ø§Ù…', pricePer100:0.08, unitText:'Ù„ÙƒÙ„ 100'},
  {id:'tt_views', name:'Ù…Ø´Ø§Ù‡Ø¯Ø§Øª TikTok', pricePer100:0.12, unitText:'Ù„ÙƒÙ„ 100'},
  {id:'tg_members', name:'Ø£Ø¹Ø¶Ø§Ø¡ ØªÙŠÙ„ØºØ±Ø§Ù…', pricePerUnit:0.10, unitText:'Ù„ÙƒÙ„ Ø¹Ø¶Ùˆ'},
  {id:'yt_views', name:'Ù…Ø´Ø§Ù‡Ø¯Ø§Øª ÙŠÙˆØªÙŠÙˆØ¨', pricePer100:0.12, unitText:'Ù„ÙƒÙ„ 100'}
];
function $(id){return document.getElementById(id);}function fmt(n){return parseFloat(n||0).toFixed(2);}function registerUser(){const u=$('regUser').value.trim();const p=$('regPass').value.trim();const phone=$('regPhone').value.trim();if(!u||!p) return alert('Ø§Ù…Ù„Ø£ ÙƒÙ„ Ø§Ù„Ø­Ù‚ÙˆÙ„');localStorage.setItem('user_'+u, JSON.stringify({user:u,pass:p,phone:phone}));if(localStorage.getItem('balance_'+u)===null) localStorage.setItem('balance_'+u,'0');alert('ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„! Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¢Ù†.');$('regUser').value='';$('regPass').value='';$('regPhone').value='';}function loginUser(){const u=$('loginUser').value.trim();const p=$('loginPass').value.trim();const raw=localStorage.getItem('user_'+u);if(!raw) return alert('Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');const obj=JSON.parse(raw);if(obj.pass!==p) return alert('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø®Ø§Ø·Ø¦Ø©');localStorage.setItem('fast10_session',u);showSection('order');updateBalancesUI();}function logout(){localStorage.removeItem('fast10_session');location.reload();}function currentUser(){return localStorage.getItem('fast10_session')||null;}function getUserBalance(u){return parseFloat(localStorage.getItem('balance_'+u)||'0')||0;}function setUserBalance(u,v){localStorage.setItem('balance_'+u,fmt(v));}function showSection(name){const map={order:'orderSection',wallet:'walletSection',orders:'ordersSection',profile:'profileSection'};['authSection','orderSection','walletSection','ordersSection','profileSection','adminLoginSection'].forEach(id=>{const el=$(id); if(el) el.style.display='none';});if(name==='order'&&!currentUser()){alert('Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹');return;}const target=map[name]||'authSection';$(target).style.display='block';if(name==='order') renderServices();if(name==='wallet') renderTopups();if(name==='orders') renderOrders();if(name==='profile') renderProfile();updateBalancesUI();}function renderServices(){const container=$('servicesContainer');container.innerHTML='';SERVICES.forEach(s=>{const div=document.createElement('div');div.className='card';div.setAttribute('data-id',s.id);div.setAttribute('data-price',s.pricePer100||s.pricePerUnit||0);div.innerHTML=`<h3>${s.name}</h3><div class="meta"><span class="muted">${s.pricePer100? s.pricePer100+'$ '+s.unitText : s.pricePerUnit+'$ '+s.unitText}</span></div><div class="row"><select class="quantitySelect"><option value="0">Ø§Ø®ØªØ± Ø§Ù„Ø¹Ø¯Ø¯</option><option value="100">100</option><option value="500">500</option><option value="1000">1000</option><option value="5000">5000</option></select></div><div style="display:flex;justify-content:space-between;align-items:center"><div class="muted">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</div><div class="total">0$</div></div>`;container.appendChild(div);});document.querySelectorAll('.quantitySelect').forEach(s=>s.onchange=updateAllInvoice);}function updateAllInvoice(){let total=0;const services=[];const quantities=[];document.querySelectorAll('.card').forEach(card=>{const id=card.getAttribute('data-id');const price=parseFloat(card.getAttribute('data-price'))||0;const qty=parseInt(card.querySelector('.quantitySelect').value)||0;if(qty>0){const svc=SERVICES.find(x=>x.id===id);let svcTotal=svc.pricePer100? price*(qty/100) : price*qty;total+=svcTotal;services.push(svc.name);quantities.push(qty);card.querySelector('.total').innerText=svcTotal.toFixed(2)+'$';}else card.querySelector('.total').innerText='0$';});if(total>0){$('invoice').style.display='block';$('invService').innerText=services.join(', ');$('invQuantity').innerText=quantities.join(', ');$('invTotal').innerText=fmt(total);}else $('invoice').style.display='none';return total;}function placeOrder(){const total=updateAllInvoice();if(total<=0) return alert('Ø§Ø®ØªØ± Ø®Ø¯Ù…Ø© ÙˆØ§Ø­Ø¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„');const user=currentUser();if(!user) return alert('Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„');let balance=getUserBalance(user);if(balance<total) return alert('Ø±ØµÙŠØ¯ ØºÙŠØ± ÙƒØ§Ù');setUserBalance(user,balance-total);const order={id:'OD-'+Date.now(),user:user,service:$('invService').innerText,qty:$('invQuantity').innerText,total:fmt(total),status:'ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø±'};const orders=JSON.parse(localStorage.getItem('fast10Orders')||'[]');orders.push(order);localStorage.setItem('fast10Orders',JSON.stringify(orders));const adminMsg=`ðŸ“© Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯\nðŸ”– Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨: ${order.id}\nðŸ‘¤ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ${order.user}\nâš¡ Ø§Ù„Ø®Ø¯Ù…Ø©: ${order.service}\nðŸ“¦ Ø§Ù„ÙƒÙ…ÙŠØ©: ${order.qty}\nðŸ’µ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${order.total}$`;window.open(`https://wa.me/${ADMIN_WHATSAPP}?text=${encodeURIComponent(adminMsg)}`,'_blank');const userObj=JSON.parse(localStorage.getItem('user_'+user)||'{}');if(userObj.phone) window.open(`https://wa.me/${userObj.phone}?text=${encodeURIComponent(`âœ… Ø´ÙƒØ±Ø§Ù‹ Ø¹Ù„Ù‰ Ø·Ù„Ø¨Ùƒ\nðŸ”– Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨: ${order.id}\nðŸ”¹ Ø§Ù„Ø®Ø¯Ù…Ø©: ${order.service}\nðŸ”¹ Ø§Ù„ÙƒÙ…ÙŠØ©: ${order.qty}\nðŸ”¹ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: ${order.total}$\nØ³ÙˆÙ Ù†ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ù‚Ø±ÙŠØ¨Ø§.`)}`,'_blank');alert('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø·Ù„Ø¨ ÙˆØ®ØµÙ… Ø§Ù„Ù…Ø¨Ù„Øº Ù…Ù† Ø±ØµÙŠØ¯Ùƒ. ØªÙ… Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø£Ø¯Ù…Ù†.');renderOrders();updateBalancesUI();}function updatePayInfo(){const method=$('topupMethod').value;$('paymentBox').style.display=method?'block':'none';if(method==='binance') $('payID').innerText=BINANCE_ID;else if(method==='payeer') $('payID').innerText='P1234567';else if(method==='poste') $('payID').innerText='C.C.P 0012354789';$('topupOrderID').innerText='SH-'+Math.floor(Math.random()*900000+100000);}function copyPayID(){navigator.clipboard.writeText($('payID').innerText);alert('ØªÙ… Ù†Ø³Ø® Ø±Ù‚Ù… Ø§Ù„Ø¯ÙØ¹');}function makeTopUpRequest(){const amount=parseFloat($('topupAmount').value)||0;const method=$('topupMethod').value;if(amount<=0||!method) return alert('Ø§Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº ÙˆØ§Ø®ØªØ± Ø§Ù„Ø·Ø±ÙŠÙ‚Ø©');const order={order:$('topupOrderID').innerText||('SH-'+Date.now()),amount:fmt(amount),method:method,status:'ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø±',user:currentUser()};const topups=JSON.parse(localStorage.getItem('fast10Topups')||'[]');topups.push(order);localStorage.setItem('fast10Topups',JSON.stringify(topups));const msg=`ðŸ”” Ø·Ù„Ø¨ Ø´Ø­Ù† Ø¬Ø¯ÙŠØ¯\nØ±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨: ${order.order}\nØ§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ${order.user}\nØ§Ù„Ù…Ø¨Ù„Øº: ${order.amount} USDT\nØ§Ù„Ø·Ø±ÙŠÙ‚Ø©: ${order.method}`;window.open(`https://wa.me/${ADMIN_WHATSAPP}?text=${encodeURIComponent(msg)}`,'_blank');alert('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø·Ù„Ø¨ Ø§Ù„Ø´Ø­Ù†. Ø£Ø±Ø³Ù„ Ø§Ù„Ù…Ø¨Ù„Øº Ù„Ù„Ø±Ù‚Ù… Ø§Ù„Ø¸Ø§Ù‡Ø± ÙˆØ£Ø±Ø³Ù„ Ø¥Ø«Ø¨Ø§Øª Ø§Ù„Ø¯ÙØ¹ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨.');renderTopups();}function renderTopups(){const list=JSON.parse(localStorage.getItem('fast10Topups')||'[]');const el=$('topupList');if(!el) return; if(list.length===0){el.innerHTML='<div>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø´Ø­Ù†</div>';return;}el.innerHTML=list.map(t=>`<div class="adminItem"><strong>${t.order}</strong> - ${t.amount} USDT - ${t.method} - <em>${t.status}</em></div>`).join('');}function renderOrders(){const list=JSON.parse(localStorage.getItem('fast10Orders')||'[]');const el=$('ordersList');if(!el) return; if(list.length===0){el.innerHTML='<div>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª</div>';return;}el.innerHTML=list.map(o=>`<div class="adminItem"><strong>${o.id}</strong> - ${o.service} - ${o.qty} - ${o.total}$ - <em>${o.status}</em></div>`).join('');}function renderProfile(){const user=currentUser();if(!user){alert('Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„');return;}$('profileName').innerText=user;$('profileBal').innerText=fmt(getUserBalance(user));}function showAdminLogin(){document.getElementById('adminLoginSection').style.display='block';}function closeAdminLogin(){document.getElementById('adminLoginSection').style.display='none';}function loginAdmin(){const u=$('adminUser').value.trim(),p=$('adminPass').value.trim();if(u==='admin'&&p==='12345'){window.open('admin.html','_blank');}else alert('Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø¯Ù…ÙŠÙ† Ø®Ø§Ø·Ø¦Ø©');}function updateBalancesUI(){const user=currentUser();if(user){$('balanceDisplay').innerText=fmt(getUserBalance(user));$('walletBalance').innerText=fmt(getUserBalance(user));}else{$('balanceDisplay').innerText='0.00';$('walletBalance').innerText='0.00';}renderOrders();renderTopups();}function clearSelections(){document.querySelectorAll('.quantitySelect').forEach(s=>s.value='0');updateAllInvoice();}window.addEventListener('load',()=>{renderServices();updateBalancesUI();});